# ğŸ› ï¸ æŠ€æœ¯å®ç°æ‘˜è¦

æœ¬æ–‡æ¡£æ±‡æ€»äº†é¡¹ç›®çš„æ ¸å¿ƒæŠ€æœ¯å®ç°é€»è¾‘ã€æœ€è¿‘ä¿®å¤çš„ Bug ä»¥åŠé¡¹ç›®æ–‡ä»¶ç»“æ„ï¼Œä¾›åç»­ç»´æŠ¤å‚è€ƒã€‚

## 1. Bug ä¿®å¤è®°å½• (Recent Fixes)

### ğŸ› æœç´¢æ¡†é—ªç°åç«‹å³æ¶ˆå¤±
*   **ç°è±¡**ï¼šå”¤èµ·æœç´¢æ¡†åï¼Œçª—å£åˆšæ˜¾ç¤º 100ms å·¦å³å°±è‡ªåŠ¨éšè—ï¼ˆè§¦å‘ Blurï¼‰ã€‚
*   **åŸå› **ï¼šåœ¨ Windows å¹³å°ä¸Šï¼Œçª—å£ `show()` ä¹‹åå¯èƒ½ä¼šå› ä¸ºæŸäº›ç³»ç»Ÿç„¦ç‚¹æŠ¢å ï¼ˆå¦‚å‰å°åº”ç”¨æŠ¢å›ç„¦ç‚¹ï¼‰å¯¼è‡´åº”ç”¨çŸ­æš‚æ¥æ”¶åˆ° `blur` äº‹ä»¶ã€‚
*   **ä¿®å¤**ï¼šåœ¨ `WindowManager` ä¸­å¼•å…¥â€œé˜²æŠ–ä¿æŠ¤æœŸâ€ã€‚
    *   `show()` æ—¶è®°å½• `lastShowTime`ã€‚
    *   `blur` äº‹ä»¶è§¦å‘æ—¶ï¼Œåˆ¤æ–­ `Date.now() - lastShowTime < 300ms`ã€‚å¦‚æœæ˜¯ï¼Œåˆ™å¼ºåˆ¶å¿½ç•¥è¯¥äº‹ä»¶ã€‚

### ğŸ› æ’ä»¶å®‰è£…åçŠ¶æ€ä¸æ›´æ–°
*   **ç°è±¡**ï¼šåœ¨å¸‚åœºå®‰è£…æ’ä»¶åï¼ŒæŒ‰é’®ä»æ˜¾ç¤ºâ€œå®‰è£…â€ï¼Œæœªå˜ä¸ºâ€œå·²å®‰è£…â€ã€‚
*   **åŸå› **ï¼šID ä¸åŒ¹é…ã€‚å¸‚åœº API è¿”å›çš„ ID (å¦‚ `plugin-demo`) ä¸æœ¬åœ°å®‰è£…åè¯»å– `package.json` çš„ `name` å­—æ®µä¸ä¸€è‡´ï¼ˆæˆ–è¯»å–è·¯å¾„é”™è¯¯ï¼‰ã€‚
*   **ä¿®å¤**ï¼šç»Ÿä¸€ä»¥**æ–‡ä»¶å¤¹åç§°**ä½œä¸ºæœ¬åœ°æ’ä»¶çš„å”¯ä¸€ IDã€‚
    *   å®‰è£…æ—¶ï¼šè§£å‹åˆ° `plugins/<id>/`ã€‚
    *   åŠ è½½æ—¶ï¼š`PluginLoader` ç›´æ¥è¯»å–æ–‡ä»¶å¤¹åä½œä¸º IDã€‚
    *   å‰ç«¯ï¼šé€šè¿‡æ¯”è¾ƒ ID ç²¾ç¡®åˆ¤æ–­å®‰è£…çŠ¶æ€ã€‚

---

## 2. æ ¸å¿ƒé€»è¾‘å®ç°

### ğŸ” åº”ç”¨æœç´¢é€»è¾‘ (App Search)
ä½ç½®ï¼š`src/main/services/search.ts`

1.  **æ•°æ®æº**ï¼šä½¿ç”¨ PowerShell å‘½ä»¤ `Get-StartApps` è·å–å¼€å§‹èœå•ä¸­çš„æ‰€æœ‰åº”ç”¨å¿«æ·æ–¹å¼ã€‚
2.  **ç´¢å¼•**ï¼š
    *   ä¸ºäº†æ€§èƒ½ï¼Œæœç´¢æœåŠ¡å¯åŠ¨æ—¶ä¼šé¢„å…ˆåŠ è½½åº”ç”¨åˆ—è¡¨å¹¶ç¼“å­˜ã€‚
    *   æ”¯æŒæ¨¡ç³ŠåŒ¹é…ï¼ˆè™½ç„¶ç›®å‰ä¸»è¦é€»è¾‘æ˜¯ç®€å•çš„åŒ…å«åŒ¹é…ï¼Œä½†é¢„ç•™äº† Fuse.js æ¥å£ï¼‰ã€‚
3.  **è¿‡æ»¤ä¸æ’åº**ï¼š
    *   å¯¹ `Uninstall` ç­‰æ— ç”¨å¿«æ·æ–¹å¼è¿›è¡Œå…³é”®è¯è¿‡æ»¤ã€‚
    *   æ ¹æ®å…³é”®è¯åŒ¹é…åº¦æ’åºï¼ˆç²¾ç¡®åŒ¹é… > åŒ…å«åŒ¹é…ï¼‰ã€‚

### ğŸ–¼ï¸ å›¾æ ‡æå–é€»è¾‘ (Icon Extraction)
ä½ç½®ï¼š`src/main/services/search.ts` (helper: `getIconViaPowershell`)

ç”±äº Electron è‡ªèº«çš„ `app.getFileIcon` API åœ¨è·å–æŸäº› UWP åº”ç”¨æˆ–ç‰¹å®šå¿«æ·æ–¹å¼å›¾æ ‡æ—¶è¡¨ç°ä¸ä½³ï¼ˆæ¸…æ™°åº¦ä½æˆ–è·å–å¤±è´¥ï¼‰ï¼Œæˆ‘ä»¬é‡‡ç”¨ PowerShell æ–¹æ¡ˆï¼š

1.  **è„šæœ¬æ‰§è¡Œ**ï¼šè°ƒç”¨ PowerShell è„šæœ¬ï¼Œåˆ©ç”¨ .NET çš„ `System.Drawing.Icon.ExtractAssociatedIcon` æ–¹æ³•ã€‚
2.  **è½¬æ¢**ï¼šå°†æå–åˆ°çš„å›¾æ ‡å¥æŸ„è½¬æ¢ä¸º Bitmapï¼Œå¹¶ç›´æ¥åºåˆ—åŒ–ä¸º Base64 PNG å­—ç¬¦ä¸²ã€‚
3.  **è¾“å‡º**ï¼šPowerShell è¾“å‡º Base64 å­—ç¬¦ä¸²ï¼ŒNode.js æ¥æ”¶åç›´æ¥ä½œä¸º `data:image/png;base64,...` ç»™å‰ç«¯å±•ç¤ºã€‚
    *   ä¼˜ç‚¹ï¼šæ— éœ€ä¸´æ—¶æ–‡ä»¶ï¼Œå³ä½¿è¢«æ‰“åŒ…åœ¨ ASAR ä¸­ä¹Ÿèƒ½æ­£å¸¸å·¥ä½œã€‚

---

## 3. é¡¹ç›®ç»“æ„æ ‘ (File Tree)

```
src/
â”œâ”€â”€ main/                       # [ä¸»è¿›ç¨‹] Electron Backend
â”‚   â”œâ”€â”€ index.ts                # å…¥å£æ–‡ä»¶ (Appç”Ÿå‘½å‘¨æœŸ, å•ä¾‹é”)
â”‚   â”œâ”€â”€ window.ts               # çª—å£ç®¡ç† (åˆ›å»º, æ˜¾ç¤º, é˜²æŠ–é€»è¾‘)
â”‚   â”œâ”€â”€ settings-window.ts      # è®¾ç½®çª—å£ç®¡ç†
â”‚   â”œâ”€â”€ ipc/
â”‚   â”‚   â””â”€â”€ handlers.ts         # IPC è·¯ç”± (å¤„ç†å‰ç«¯çš„æ‰€æœ‰ invokeè¯·æ±‚)
â”‚   â”œâ”€â”€ services/
â”‚   â”‚   â”œâ”€â”€ search.ts           # æœç´¢æ ¸å¿ƒ (åº”ç”¨æœç´¢, å›¾æ ‡æå–)
â”‚   â”‚   â”œâ”€â”€ plugin-loader.ts    # æ’ä»¶åŠ è½½å™¨ (Node.js æ¨¡å—åŠ è½½, é€‚é…å™¨)
â”‚   â”‚   â”œâ”€â”€ plugin-market.ts    # æ’ä»¶å¸‚åœº (ä¸‹è½½, è§£å‹, å®‰è£…, å¸è½½)
â”‚   â”‚   â”œâ”€â”€ hotkey.ts           # å…¨å±€å¿«æ·é”® (uIOhook)
â”‚   â”‚   â””â”€â”€ clipboard.ts        # å‰ªè´´æ¿å†å²ç®¡ç†
â”‚   â””â”€â”€ utils/
â”‚       â”œâ”€â”€ config.ts           # é…ç½®è¯»å†™ (electron-store)
â”‚       â””â”€â”€ logger.ts           # æ—¥å¿—å·¥å…·
â”‚
â”œâ”€â”€ renderer/                   # [æ¸²æŸ“è¿›ç¨‹] Vue 3 Frontend
â”‚   â”œâ”€â”€ components/
â”‚   â”‚   â”œâ”€â”€ SearchBar.vue       # ä¸»æœç´¢æ¡†
â”‚   â”‚   â”œâ”€â”€ ResultList.vue      # æœç´¢ç»“æœåˆ—è¡¨
â”‚   â”‚   â””â”€â”€ settings/           # è®¾ç½®é¡µé¢
â”‚   â”‚       â”œâ”€â”€ GeneralSettings.vue
â”‚   â”‚       â”œâ”€â”€ AdvancedSettings.vue
â”‚   â”‚       â””â”€â”€ PluginManager.vue # æ’ä»¶ç®¡ç† (å¸‚åœº, æœ¬åœ°)
â”‚   â”œâ”€â”€ composables/            # Vue Hooks (I18nç­‰)
â”‚   â””â”€â”€ App.vue                 # æ ¹ç»„ä»¶ (è·¯ç”±åˆ†å‘)
â”‚
â”œâ”€â”€ preload/                    # [é¢„åŠ è½½è„šæœ¬]
â”‚   â””â”€â”€ index.ts                # æš´éœ² Electron API ç»™æ¸²æŸ“è¿›ç¨‹ (ContextBridge)
â”‚
â””â”€â”€ shared/                     # [å…±äº«ç±»å‹]
    â”œâ”€â”€ constants.ts            # IPC é€šé“åç§°å®šä¹‰
    â””â”€â”€ types/                  # TypeScript æ¥å£å®šä¹‰
```
